"use strict";(self.webpackChunkinterzone=self.webpackChunkinterzone||[]).push([[42624,21299],{21299:(t,e,n)=>{function a(t){return"0x".concat(t.reduce(((t,e)=>t+e.replace("0x","")),""))}n.r(e),n.d(e,{concatHex:()=>a})},42624:(t,e,n)=>{n.r(e),n.d(e,{connectSmartWallet:()=>Ot,disconnectSmartWallet:()=>Tt,isSmartWallet:()=>xt,personalAccountToSmartAccountMap:()=>Gt});var a=n(34316);const r=2n**96n-1n;var s=n(9893),i=n(38736),o=n(86511);const c="0xdd62ed3e",u=[{type:"address",name:"owner"},{type:"address",name:"spender"}],d=[{type:"uint256"}];var l=n(7911),p=n(77300),y=n(77378),m=n(72364),v=n(3340);function f(t){if(["string","number"].includes(typeof t)&&!Number.isInteger(Number(t)))throw new Error("Expected value to be an integer to convert to a bigint, got ".concat(t," of type ").concat(typeof t));return t instanceof Uint8Array?BigInt((0,v.EY)(t)):BigInt(t)}var h=n(21299),g=n(46325),w=n(79002);const b=50000n,A=t=>{const e=function(t){const{gas:e,nonce:n,to:a,from:r,value:s,maxFeePerGas:i,maxPriorityFeePerGas:o,paymaster:c,paymasterInput:u,gasPerPubdata:d,data:l}=t;return{txType:113n,from:BigInt(r),to:a?BigInt(a):0n,gasLimit:null!==e&&void 0!==e?e:0n,gasPerPubdataByteLimit:null!==d&&void 0!==d?d:b,maxFeePerGas:null!==i&&void 0!==i?i:0n,maxPriorityFeePerGas:null!==o&&void 0!==o?o:0n,paymaster:c?BigInt(c):0n,nonce:n?BigInt(n):0n,value:null!==s&&void 0!==s?s:0n,data:l||"0x0",factoryDeps:[],paymasterInput:u||"0x"}}(t);return{domain:{name:"zkSync",version:"2",chainId:t.chainId},types:{Transaction:[{name:"txType",type:"uint256"},{name:"from",type:"uint256"},{name:"to",type:"uint256"},{name:"gasLimit",type:"uint256"},{name:"gasPerPubdataByteLimit",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymaster",type:"uint256"},{name:"nonce",type:"uint256"},{name:"value",type:"uint256"},{name:"data",type:"bytes"},{name:"factoryDeps",type:"bytes32[]"},{name:"paymasterInput",type:"bytes"}]},primaryType:"Transaction",message:e}};async function P(t){const{account:e,eip712Transaction:n,chainId:a}=t,r=A(n),s=await e.signTypedData({...r});return function(t){const{chainId:e,gas:n,nonce:a,to:r,from:s,value:i,maxFeePerGas:o,maxPriorityFeePerGas:c,customSignature:u,factoryDeps:d,paymaster:l,paymasterInput:p,gasPerPubdata:m,data:f}=t,g=[a?(0,v.nj)(a):"0x",c?(0,v.nj)(c):"0x",o?(0,v.nj)(o):"0x",n?(0,v.nj)(n):"0x",null!==r&&void 0!==r?r:"0x",i?(0,v.nj)(i):"0x",null!==f&&void 0!==f?f:"0x0",(0,v.nj)(e),(0,v.nj)(""),(0,v.nj)(""),(0,v.nj)(e),null!==s&&void 0!==s?s:"0x",m?(0,v.nj)(m):(0,v.nj)(b),null!==d&&void 0!==d?d:[],null!==u&&void 0!==u?u:"0x",l&&p?[l,p]:[]];return(0,h.concatHex)(["0x71",(0,y.EQ)(g)])}({...n,chainId:a,customSignature:s})}async function x(t){const{account:e,transaction:n}=t;let[a,r,s,i,o,c,u]=await Promise.all([(0,w.encode)(n),(0,g.r)(n.to),(0,g.r)(n.value),(0,g.r)(n.gas),(0,g.r)(n.maxFeePerGas),(0,g.r)(n.maxPriorityFeePerGas),(0,g.r)(n.eip712).then((t=>null===t||void 0===t?void 0:t.gasPerPubdata))]);if(!i||!o||!c){const t=(0,m.getRpcClient)(n),d=await t({method:"zks_estimateFee",params:[{from:e.address,to:r,data:a,value:s?(0,v.cK)(s):void 0}]});i=f(d.gas_limit);o=2n*f(d.max_fee_per_gas),c=f(d.max_priority_fee_per_gas)||1n,u=f(d.gas_per_pubdata_limit)}return{...await(0,p.$)({transaction:{...n,gas:i,maxFeePerGas:o,maxPriorityFeePerGas:c},from:e.address}),...n.eip712,gasPerPubdata:u,from:e.address}}var G=n(83423),I=n(93300),O=n(80884),T=n(97965),C=n(3491),U=n(74074);var B=n(37131),S=n(94837),L=n(22017),M=n(43687);const D=M.k;var j=n(99577),k=n(63206),F=n(59052);const E="/docs/contract/decodeEventLog";function N(t){let{param:e,value:n}=t;if("string"===e.type||"bytes"===e.type||"tuple"===e.type||e.type.match(/^(.*)\[(\d+)?\]$/))return n;return((0,k.n)([e],n)||[])[0]}var _=n(31499),H=n(73924);function V(t){const{abi:e,args:n=[],name:a}=t,r=(0,_.q)(a,{strict:!1}),s=e.filter((t=>r?"function"===t.type?(0,H.V)(t)===a:"event"===t.type&&D(t)===a:"name"in t&&t.name===a));if(0===s.length)return;if(1===s.length)return s[0];let i;for(const o of s){if(!("inputs"in o))continue;if(!n||0===n.length){if(!o.inputs||0===o.inputs.length)return o;continue}if(!o.inputs)continue;if(0===o.inputs.length)continue;if(o.inputs.length!==n.length)continue;if(n.every(((t,e)=>{const n="inputs"in o&&o.inputs[e];return!!n&&W(t,n)}))){if(i&&"inputs"in i&&i.inputs){const t=R(o.inputs,i.inputs,n);if(t)throw new T.nM({abiItem:o,type:t[0]},{abiItem:i,type:t[1]})}i=o}}return i||s[0]}function W(t,e){const n=typeof t,a=e.type;switch(a){case"address":return(0,U.P)(t,{strict:!1});case"bool":return"boolean"===n;case"function":case"string":return"string"===n;default:return"tuple"===a&&"components"in e?Object.values(e.components).every(((e,n)=>W(Object.values(t)[n],e))):/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(a)?"number"===n||"bigint"===n:/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(a)?"string"===n||t instanceof Uint8Array:!!/[a-z]+[1-9]{0,3}(\[[0-9]{0,}\])+$/.test(a)&&(Array.isArray(t)&&t.every((t=>W(t,{...e,type:a.replace(/(\[[0-9]{0,}\])$/,"")}))))}}function R(t,e,n){for(const a in t){const r=t[a],s=e[a];if("tuple"===r.type&&"tuple"===s.type&&"components"in r&&"components"in s)return R(r.components,s.components,n[a]);const i=[r.type,s.type];if(!(!i.includes("address")||!i.includes("bytes20"))||(i.includes("address")&&i.includes("string")||!(!i.includes("address")||!i.includes("bytes")))&&(0,U.P)(n[a],{strict:!1}))return i}}function z(t){const{abi:e,args:n,logs:a,strict:r=!0}=t,s=(()=>{if(t.eventName)return Array.isArray(t.eventName)?t.eventName:[t.eventName]})();return a.map((t=>{try{const a=V({abi:e,name:t.topics[0]});if(!a)return null;const i=function(t){const{abi:e,data:n,strict:a,topics:r}=t,s=null===a||void 0===a||a,[i,...o]=r;if(!i)throw new T._z({docsPath:E});const c=e.find((t=>"event"===t.type&&i===D((0,F.B)(t))));if(!c||!("name"in c)||"event"!==c.type)throw new T.kE(i,{docsPath:E});const{name:u,inputs:d}=c,l=null===d||void 0===d?void 0:d.some((t=>!("name"in t&&t.name)));let p=l?[]:{};const y=d.filter((t=>"indexed"in t&&t.indexed));for(let f=0;f<y.length;f++){const t=y[f],e=o[f];if(!e)throw new T.l3({abiItem:c,param:t});p[l?f:t.name||f]=N({param:t,value:e})}const m=d.filter((t=>!("indexed"in t&&t.indexed)));if(m.length>0)if(n&&"0x"!==n)try{const t=(0,k.n)(m,n);if(t)if(l)p=[...p,...t];else for(let e=0;e<m.length;e++)p[m[e].name]=t[e]}catch(v){if(s){if(v instanceof T.Iy||v instanceof j.SK)throw new T.fo({abiItem:c,data:n,params:m,size:(0,L.E)(n)});throw v}}else if(s)throw new T.fo({abiItem:c,data:"0x",params:m,size:0});return{eventName:u,args:Object.values(p).length>0?p:void 0}}({...t,abi:[a],strict:r});return s&&!s.includes(i.eventName)?null:function(t){const{args:e,inputs:n,matchArgs:a}=t;if(!a)return!0;if(!e)return!1;function r(t,e,n){try{return"address"===t.type?function(t,e){if(!(0,U.P)(t,{strict:!1}))throw new C.M({address:t});if(!(0,U.P)(e,{strict:!1}))throw new C.M({address:e});return t.toLowerCase()===e.toLowerCase()}(e,n):"string"===t.type||"bytes"===t.type?(0,S.S)((0,B.ZJ)(e))===n:e===n}catch{return!1}}if(Array.isArray(e)&&Array.isArray(a))return a.every(((t,a)=>{if(!t)return!0;const s=n[a];if(!s)return!1;return(Array.isArray(t)?t:[t]).some((t=>r(s,t,e[a])))}));return"object"===typeof e&&!Array.isArray(e)&&"object"===typeof a&&!Array.isArray(a)&&Object.entries(a).every((t=>{let[a,s]=t;if(!s)return!0;const i=n.find((t=>t.name===a));if(!i)return!1;return(Array.isArray(s)?s:[s]).some((t=>r(i,t,e[a])))}))}({args:i.args,inputs:a.inputs,matchArgs:n})?{...i,...t}:null}catch(i){let e,n;if(i instanceof T.kE)return null;if(i instanceof T.fo||i instanceof T.l3){var a;if(r)return null;e=i.abiItem.name,n=null===(a=i.abiItem.inputs)||void 0===a?void 0:a.some((t=>!("name"in t&&t.name)))}return{...t,args:n?[]:{},eventName:e}}})).filter(Boolean)}var $=n(55907),q=n(21627);class K extends q.C{constructor(t){super('Filter type "'.concat(t,'" is not supported.'),{name:"FilterTypeNotSupportedError"})}}var Z=n(31376);const J="/docs/contract/encodeEventTopics";function Q(t){const{abi:e,eventName:n,args:a}=t;let r=e[0];if(n){const t=V({abi:e,name:n});if(!t)throw new T.M_(n,{docsPath:J});r=t}if("event"!==r.type)throw new T.M_(void 0,{docsPath:J});const s=(0,F.B)(r),i=D(s);let o=[];if(a&&"inputs"in r){var c,u;const t=null===(c=r.inputs)||void 0===c?void 0:c.filter((t=>"indexed"in t&&t.indexed)),e=Array.isArray(a)?a:Object.values(a).length>0&&null!==(u=null===t||void 0===t?void 0:t.map((t=>a[t.name])))&&void 0!==u?u:[];var d;if(e.length>0)o=null!==(d=null===t||void 0===t?void 0:t.map(((t,n)=>Array.isArray(e[n])?e[n].map(((a,r)=>Y({param:t,value:e[n][r]}))):e[n]?Y({param:t,value:e[n]}):null)))&&void 0!==d?d:[]}return[i,...o]}function Y(t){let{param:e,value:n}=t;if("string"===e.type||"bytes"===e.type)return(0,S.S)((0,B.ZJ)(n));if("tuple"===e.type||e.type.match(/^(.*)\[(\d+)?\]$/))throw new K(e.type);return(0,Z.h)([e],[n])}function X(){return function(t){const{signature:e}=t;let n;var a;return n=(a=e)&&"object"===typeof a&&"type"in a&&"event"===a.type?e:(0,$.$)(e),{abiEvent:n,hash:(0,M.k)(n),topics:Q({abi:[n],args:t.filters})}}({signature:"event UserOperationRevertReason(bytes32 indexed userOpHash, address indexed sender, uint256 nonce, bytes revertReason)",filters:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}})}var tt=n(49703),et=n(77717);var nt=n(20635),at=n(97779);const rt=()=>{const t=BigInt(Math.floor(4294967296*Math.random())),e=BigInt(Math.floor(4294967296*Math.random())),n=BigInt(Math.floor(4294967296*Math.random())),a=BigInt(Math.floor(4294967296*Math.random())),r=BigInt(Math.floor(4294967296*Math.random())),s=BigInt(Math.floor(4294967296*Math.random()));return t<<BigInt(160)|e<<BigInt(128)|n<<BigInt(96)|a<<BigInt(64)|r<<BigInt(32)|s};function st(t){return Object.fromEntries(Object.entries(t).map((t=>{let[e,n]=t;return[e,(0,at.q)(n)?n:(0,v.nj)(n)]})))}async function it(t){var e;const n=await ct({...t,operation:"eth_estimateUserOperationGas",params:[st(t.userOp),null!==(e=t.options.entrypointAddress)&&void 0!==e?e:nt.uh]});return{preVerificationGas:(0,v.uU)(n.preVerificationGas),verificationGas:(0,v.uU)(n.verificationGas),verificationGasLimit:(0,v.uU)(n.verificationGasLimit),callGasLimit:(0,v.uU)(n.callGasLimit)+nt.L8}}async function ot(t){const e=await async function(t){const e=await ct({options:t,operation:"eth_getUserOperationReceipt",params:[t.userOpHash]});if(!e)return;return function(t){const{receipt:e}=t,n={...e,transactionHash:e.transactionHash,blockNumber:e.blockNumber?BigInt(e.blockNumber):null,contractAddress:e.contractAddress?e.contractAddress:null,cumulativeGasUsed:e.cumulativeGasUsed?BigInt(e.cumulativeGasUsed):null,effectiveGasPrice:e.effectiveGasPrice?BigInt(e.effectiveGasPrice):null,gasUsed:e.gasUsed?BigInt(e.gasUsed):null,logs:e.logs,to:e.to?e.to:null,transactionIndex:e.transactionIndex,status:e.status,type:e.type};return e.blobGasPrice&&(n.blobGasPrice=BigInt(e.blobGasPrice)),e.blobGasUsed&&(n.blobGasUsed=BigInt(e.blobGasUsed)),{...t,receipt:n,userOpHash:t.userOpHash,actualGasCost:BigInt(t.actualGasCost),actualGasUsed:BigInt(t.actualGasUsed),nonce:BigInt(t.nonce)}}(e)}(t);if(e){if(!1===e.success){var n;const t=null===(n=function(t){const{logs:e,events:n,strict:a}=t;return z({logs:e,abi:n.map((t=>t.abiEvent)),strict:a})}({events:[X()],logs:e.logs})[0])||void 0===n||null===(n=n.args)||void 0===n?void 0:n.revertReason;if(!t)throw new Error("UserOp failed at txHash: ".concat(e.receipt.transactionHash));const a=(0,O.W)({data:t});throw new Error("UserOp failed with reason: '".concat(a.args.join(","),"' at txHash: ").concat(e.receipt.transactionHash))}return e.receipt}}async function ct(t){var e;const{options:n,operation:a,params:r}=t;nt.Oi&&console.debug(">>> sending ".concat(a," with payload:"),r);const s=null!==(e=n.bundlerUrl)&&void 0!==e?e:(0,nt.RZ)(n.chain),i=(0,tt.KI)(n.client),o=await i(s,{method:"POST",headers:{"Content-Type":"application/json"},body:(0,et.A)({jsonrpc:"2.0",id:1,method:a,params:r})}),c=await o.json();if(!o.ok||c.error){let t=c.error||o.statusText;"object"===typeof t&&(t=JSON.stringify(t));const e=c.code||"UNKNOWN";throw new Error("".concat(a," error: ").concat(t,"\nStatus: ").concat(o.status,"\nCode: ").concat(e))}return nt.Oi&&console.debug("<<< ".concat(a," result:"),c),c.result}var ut=n(77877);function dt(t){const{accountContract:e,transaction:n,executeOverride:a}=t;return a?a(e,n):(0,ut.m)({contract:e,method:"function execute(address, uint256, bytes)",params:[n.to||"",n.value||0n,n.data||"0x"]})}var lt=n(52620);const pt="0x35567e1a",yt=[{type:"address",name:"sender"},{type:"uint192",name:"key"}],mt=[{type:"uint256",name:"nonce"}];var vt=n(22561),ft=n(28482),ht=n(69961),gt=n(42002),wt=n(45287);async function bt(t){var e;const{userOp:n,paymasterOverride:a,client:r,chain:s,entrypointAddress:i}=t;if(a)return a(n);const o=(0,nt.lI)(s),c=null!==i&&void 0!==i?i:nt.uh,u=(0,tt.KI)(r),d=await u(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:1,method:"pm_sponsorUserOperation",params:[st(n),c]})}),l=await d.json();if(!d.ok){const t=l.error||d.statusText,e=l.code||"UNKNOWN";throw new Error("Paymaster error: ".concat(t,"\nStatus: ").concat(d.status,"\nCode: ").concat(e))}if(nt.Oi&&console.debug("Paymaster result:",l),l.result)return"string"===typeof l.result?{paymasterAndData:l.result}:{paymasterAndData:l.result.paymasterAndData,verificationGasLimit:l.result.verificationGasLimit?(0,v.uU)(l.result.verificationGasLimit):void 0,preVerificationGas:l.result.preVerificationGas?(0,v.uU)(l.result.preVerificationGas):void 0,callGasLimit:l.result.callGasLimit?(0,v.uU)(l.result.callGasLimit):void 0};const p=(null===(e=l.error)||void 0===e?void 0:e.message)||l.error||d.statusText||"unknown error";throw new Error("Paymaster error from ".concat(o,": ").concat(p))}async function At(t){var e;const{transaction:n,accountContract:a,factoryContract:r,adminAddress:s,overrides:c,sponsorGas:u}=t,d=n.chain,l=n.client,p=await(0,ht.isContractDeployed)(a)?"0x":await async function(t){const{factoryContract:e,adminAddress:n,accountSalt:a,createAccountOverride:r}=t,s=function(t){const{adminAddress:e,factoryContract:n,createAccountOverride:a,accountSalt:r}=t;return a?a(n):(0,ut.m)({contract:n,method:"function createAccount(address, bytes) returns (address)",params:[e,(0,v.i3)(null!==r&&void 0!==r?r:"")]})}({factoryContract:e,adminAddress:n,accountSalt:a,createAccountOverride:r});return(0,lt.xW)([e.address,await(0,w.encode)(s)])}({factoryContract:r,adminAddress:s,accountSalt:null===c||void 0===c?void 0:c.accountSalt,createAccountOverride:null===c||void 0===c?void 0:c.createAccount}),y=await(0,w.encode)(n),m={client:l,chain:d,entrypointAddress:null===c||void 0===c?void 0:c.entrypointAddress};let{maxFeePerGas:f,maxPriorityFeePerGas:h}=n;const b=null!==(e=null===c||void 0===c?void 0:c.bundlerUrl)&&void 0!==e?e:(0,nt.RZ)(d);if((0,tt.Lj)(b)){const t=await async function(t){const e=await ct({...t,operation:"thirdweb_getUserOperationGasPrice",params:[]});return{maxPriorityFeePerGas:(0,v.uU)(e.maxPriorityFeePerGas),maxFeePerGas:(0,v.uU)(e.maxFeePerGas)}}({options:m});f=t.maxFeePerGas,h=t.maxPriorityFeePerGas}else{const[t,e]=await Promise.all([(0,g.r)(f),(0,g.r)(h)]);if(t&&e)f=t,h=e;else{var A,P;const n=await(0,vt.G)(l,d);h=null!==(A=null!==e&&void 0!==e?e:n.maxPriorityFeePerGas)&&void 0!==A?A:0n,f=null!==(P=null!==t&&void 0!==t?t:n.maxFeePerGas)&&void 0!==P?P:0n}}const x=await async function(t){const{accountContract:e,chain:n,client:a,entrypointAddress:r,getNonceOverride:s}=t;if(s)return s(e);return async function(t){return(0,o.readContract)({contract:t.contract,method:[pt,yt,mt],params:[t.sender,t.key]})}({contract:(0,i.P)({address:r||nt.uh,chain:n,client:a}),key:rt(),sender:e.address})}({accountContract:a,chain:d,client:l,entrypointAddress:null===c||void 0===c?void 0:c.entrypointAddress,getNonceOverride:null===c||void 0===c?void 0:c.getAccountNonce}),G={sender:a.address,nonce:x,initCode:p,callData:y,maxFeePerGas:f,maxPriorityFeePerGas:h,callGasLimit:0n,verificationGasLimit:0n,preVerificationGas:0n,paymasterAndData:"0x",signature:nt.km};if(u){const t=await bt({userOp:G,chain:d,client:l,entrypointAddress:null===c||void 0===c?void 0:c.entrypointAddress,paymasterOverride:null===c||void 0===c?void 0:c.paymaster}),e=t.paymasterAndData;if(e&&"0x"!==e&&(G.paymasterAndData=e),t.callGasLimit&&t.verificationGasLimit&&t.preVerificationGas)G.callGasLimit=t.callGasLimit,G.verificationGasLimit=t.verificationGasLimit,G.preVerificationGas=t.preVerificationGas;else{const t=await it({userOp:G,options:m});if(G.callGasLimit=t.callGasLimit,G.verificationGasLimit=t.verificationGasLimit,G.preVerificationGas=t.preVerificationGas,e&&"0x"!==e){const t=await bt({userOp:G,chain:d,client:l,entrypointAddress:null===c||void 0===c?void 0:c.entrypointAddress,paymasterOverride:null===c||void 0===c?void 0:c.paymaster});t.paymasterAndData&&"0x"!==t.paymasterAndData&&(G.paymasterAndData=t.paymasterAndData)}}}else{const t=await it({userOp:G,options:m});G.callGasLimit=t.callGasLimit,G.verificationGasLimit=t.verificationGasLimit,G.preVerificationGas=t.preVerificationGas}return{...G,signature:"0x"}}async function Pt(t){const{userOp:e,chain:n,entrypointAddress:a,adminAccount:r}=t,s=function(t){const{userOp:e,entryPoint:n,chainId:a}=t,r=(0,wt.S)(e.initCode),s=(0,wt.S)(e.callData),i=(0,wt.S)(e.paymasterAndData),o=(0,ft.encodeAbiParameters)([{type:"address"},{type:"uint256"},{type:"bytes32"},{type:"bytes32"},{type:"uint256"},{type:"uint256"},{type:"uint256"},{type:"uint256"},{type:"uint256"},{type:"bytes32"}],[e.sender,e.nonce,r,s,e.callGasLimit,e.verificationGasLimit,e.preVerificationGas,e.maxFeePerGas,e.maxPriorityFeePerGas,i]),c=(0,ft.encodeAbiParameters)([{type:"bytes32"},{type:"address"},{type:"uint256"}],[(0,wt.S)(o),n,BigInt(a)]);return(0,wt.S)(c)}({userOp:e,entryPoint:a||nt.uh,chainId:n.id});if(r.signMessage){const t=await r.signMessage({message:{raw:(0,gt.aT)(s)}});return{...e,signature:t}}throw new Error("signMessage not implemented in signingAccount")}function xt(t){return"smart"===t.id}const Gt=new WeakMap,It=new WeakMap;async function Ot(t,e,s){var y,m,f,g;const{personalAccount:w,client:b,chain:A}=e;if(!w)throw new Error("Personal wallet does not have an account");const P=s,x=null!==(y=P.factoryAddress)&&void 0!==y?y:nt.zk,O=null!==A&&void 0!==A?A:P.chain,T="gasless"in P?P.gasless:P.sponsorGas;if(function(t){return 324===t.id||300===t.id||302===t.id||11124===t.id}(O))return[Ct({creationOptions:s,connectionOptions:e,chain:O,sponsorGas:T}),O];const C=(0,i.P)({client:b,address:x,chain:O}),U=await async function(t){const{factoryContract:e,predictAddressOverride:n,adminAddress:a,accountSalt:r,accountAddress:s}=t;if(n)return n(e);if(s)return s;if(!a)throw new Error("Account address is required to predict the smart wallet address.");const i=(0,v.i3)(null!==r&&void 0!==r?r:"");return(0,o.readContract)({contract:e,method:"function getAddress(address, bytes) returns (address)",params:[a,i]})}({factoryContract:C,adminAddress:w.address,predictAddressOverride:null===(m=P.overrides)||void 0===m?void 0:m.predictAddress,accountSalt:null===(f=P.overrides)||void 0===f?void 0:f.accountSalt,accountAddress:null===(g=P.overrides)||void 0===g?void 0:g.accountAddress}).then((t=>t)).catch((t=>{throw new Error("Failed to get account address with factory contract ".concat(C.address," on chain ID ").concat(O.id,". Are you on the right chain?"),{cause:t})})),B=(0,i.P)({client:b,address:U,chain:O}),S=await async function(t){const{accountContract:e}=t,s={address:(0,G.bv)(e.address),async sendTransaction(n){var a,s;const y=null===(a=t.overrides)||void 0===a?void 0:a.erc20Paymaster;let m;if(y){var v;await async function(t){var e;const{accountContract:n,erc20Paymaster:a,options:s}=t,y=a.token,m=(0,i.P)({address:y,chain:n.chain,client:n.client}),v=await async function(t){return(0,o.readContract)({contract:t.contract,method:[c,u,d],params:[t.owner,t.spender]})}({contract:m,owner:n.address,spender:a.address});if(v>0n)return;const f=(0,l.S)({contract:m,spender:a.address,amountWei:r-1n}),h=await(0,p.$)({transaction:f,from:n.address}),g=dt({accountContract:n,transaction:h,executeOverride:null===(e=s.overrides)||void 0===e?void 0:e.execute});await Bt({executeTx:g,options:{...s,overrides:{...s.overrides,erc20Paymaster:void 0}}})}({accountContract:e,erc20Paymaster:y,options:t});const n=async()=>({paymasterAndData:(0,h.concatHex)([y.address,null===y||void 0===y?void 0:y.token])});m=(null===(v=t.overrides)||void 0===v?void 0:v.paymaster)||n}return Bt({executeTx:dt({accountContract:e,transaction:n,executeOverride:null===(s=t.overrides)||void 0===s?void 0:s.execute}),options:{...t,overrides:{...t.overrides,paymaster:m}}})},async sendBatchTransaction(n){var a;const r=function(t){const{accountContract:e,transactions:n,executeBatchOverride:a}=t;return a?a(e,n):(0,ut.m)({contract:e,method:"function executeBatch(address[], uint256[], bytes[])",params:[n.map((t=>t.to||"")),n.map((t=>t.value||0n)),n.map((t=>t.data||"0x"))]})}({accountContract:e,transactions:n,executeBatchOverride:null===(a=t.overrides)||void 0===a?void 0:a.executeBatch});return Bt({executeTx:r,options:t})},async signMessage(a){let{message:r}=a;const[{isContractDeployed:i},{readContract:o},{encodeAbiParameters:c},{hashMessage:u},{checkContractWalletSignature:d}]=await Promise.all([Promise.resolve().then(n.bind(n,69961)),Promise.resolve().then(n.bind(n,86511)),Promise.resolve().then(n.bind(n,28482)),n.e(67143).then(n.bind(n,67143)),n.e(76603).then(n.bind(n,76603))]);await i(e)||await Ut({options:t,account:s,accountContract:e});const l=u(r);let p,y=!1;try{await o({contract:e,method:"function getMessageHash(bytes32 _hash) public view returns (bytes32)",params:[l]}),y=!0}catch(m){}if(y){const n=c([{type:"bytes32"}],[l]);p=await t.personalAccount.signTypedData({domain:{name:"Account",version:"1",chainId:t.chain.id,verifyingContract:e.address},primaryType:"AccountMessage",types:{AccountMessage:[{name:"message",type:"bytes"}]},message:{message:n}})}else p=await t.personalAccount.signMessage({message:r});if(await d({contract:e,message:r,signature:p}))return p;throw new Error("Unable to verify signature on smart account, please make sure the smart account is deployed and the signature is valid.")},async signTypedData(r){var i,o;const c=(0,I.y)(r),[{isContractDeployed:u},{readContract:d},{encodeAbiParameters:l},{checkContractWalletSignedTypedData:p}]=await Promise.all([Promise.resolve().then(n.bind(n,69961)),Promise.resolve().then(n.bind(n,86511)),Promise.resolve().then(n.bind(n,28482)),n.e(48143).then(n.bind(n,48143))]);if((null===(i=c.domain)||void 0===i||null===(i=i.verifyingContract)||void 0===i?void 0:i.toLowerCase())===(null===(o=e.address)||void 0===o?void 0:o.toLowerCase()))return t.personalAccount.signTypedData(c);await u(e)||await Ut({options:t,account:s,accountContract:e});const y=(0,a.Zh)(c);let m,v=!1;try{await d({contract:e,method:"function getMessageHash(bytes32 _hash) public view returns (bytes32)",params:[y]}),v=!0}catch(f){}if(v){const n=l([{type:"bytes32"}],[y]);m=await t.personalAccount.signTypedData({domain:{name:"Account",version:"1",chainId:t.chain.id,verifyingContract:e.address},primaryType:"AccountMessage",types:{AccountMessage:[{name:"message",type:"bytes"}]},message:{message:n}})}else m=await t.personalAccount.signTypedData(c);if(await p({contract:e,data:c,signature:m}))return m;throw new Error("Unable to verify signature on smart account, please make sure the smart account is deployed and the signature is valid.")},async onTransactionRequested(e){var n,a;return null===(n=(a=t.personalAccount).onTransactionRequested)||void 0===n?void 0:n.call(a,e)}};return s}({...P,chain:O,sponsorGas:T,personalAccount:w,accountContract:B,factoryContract:C,client:b});return Gt.set(w,t),It.set(t,w),[S,O]}async function Tt(t){const e=It.get(t);e&&(Gt.delete(e),It.delete(t))}function Ct(t){const{creationOptions:e,connectionOptions:n,chain:a}=t,r={address:n.personalAccount.address,async sendTransaction(i){var o,c,u,d;const l={data:i.data,to:null!==(o=i.to)&&void 0!==o?o:void 0,value:null!==(c=i.value)&&void 0!==c?c:0n,chain:(0,s.Q4)(i.chainId),client:n.client};let p=await x({account:r,transaction:l});if(t.sponsorGas){var y,m;const t=await async function(t){const e=await ct({options:t.options,operation:"zk_paymasterData",params:[t.transaction]});return{paymaster:e.paymaster,paymasterInput:e.paymasterInput}}({options:{client:n.client,chain:a,bundlerUrl:null===(y=e.overrides)||void 0===y?void 0:y.bundlerUrl,entrypointAddress:null===(m=e.overrides)||void 0===m?void 0:m.entrypointAddress},transaction:p});p={...p,...t}}const v=await P({account:r,chainId:a.id,eip712Transaction:p}),f=await async function(t){return{transactionHash:(await ct({options:t.options,operation:"zk_broadcastTransaction",params:[{...t.transaction,signedTransaction:t.signedTransaction}]})).transactionHash}}({options:{client:n.client,chain:a,bundlerUrl:null===(u=e.overrides)||void 0===u?void 0:u.bundlerUrl,entrypointAddress:null===(d=e.overrides)||void 0===d?void 0:d.entrypointAddress},transaction:p,signedTransaction:v});return{transactionHash:f.transactionHash,client:n.client,chain:a}},async signMessage(t){let{message:e}=t;return n.personalAccount.signMessage({message:e})},async signTypedData(t){const e=(0,I.y)(t);return n.personalAccount.signTypedData(e)},async onTransactionRequested(t){var e,a;return null===(e=(a=n.personalAccount).onTransactionRequested)||void 0===e?void 0:e.call(a,t)}};return r}async function Ut(t){const{options:e,account:a,accountContract:r}=t,[{sendTransaction:s},{prepareTransaction:i}]=await Promise.all([Promise.resolve().then(n.bind(n,96223)),Promise.resolve().then(n.bind(n,21300))]),o=i({client:e.client,chain:e.chain,to:r.address,value:0n,gas:50000n});return await s({transaction:o,account:a})}async function Bt(t){var e;const{executeTx:n,options:a}=t,r=await At({transaction:n,factoryContract:a.factoryContract,accountContract:a.accountContract,adminAddress:a.personalAccount.address,sponsorGas:a.sponsorGas,overrides:a.overrides}),s=await Pt({chain:a.chain,adminAccount:a.personalAccount,entrypointAddress:null===(e=a.overrides)||void 0===e?void 0:e.entrypointAddress,userOp:r}),i=await async function(t){var e;return ct({...t,operation:"eth_sendUserOperation",params:[st(t.userOp),null!==(e=t.options.entrypointAddress)&&void 0!==e?e:nt.uh]})}({options:a,userOp:s}),o=await async function(t){const e=t.timeoutMs||12e4,n=t.intervalMs||1e3,a=Date.now()+e;for(;Date.now()<a;){const e=await ot(t);if(e)return e;await new Promise((t=>setTimeout(t,n)))}throw new Error("Timeout waiting for userOp to be mined")}({...a,userOpHash:i});return{client:a.client,chain:a.chain,transactionHash:o.transactionHash}}},77378:(t,e,n)=>{n.d(e,{EQ:()=>o});var a=n(21627),r=n(30751),s=n(37131),i=n(84117);function o(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hex";const n=c(t),a=(0,r.l)(new Uint8Array(n.length));return n.encode(a),"hex"===e?(0,i.My)(a.bytes):a.bytes}function c(t){return Array.isArray(t)?function(t){const e=t.reduce(((t,e)=>t+e.length),0),n=u(e);return{length:e<=55?1+e:1+n+e,encode(a){e<=55?a.pushByte(192+e):(a.pushByte(247+n),1===n?a.pushUint8(e):2===n?a.pushUint16(e):3===n?a.pushUint24(e):a.pushUint32(e));for(const{encode:e}of t)e(a)}}}(t.map((t=>c(t)))):function(t){const e="string"===typeof t?(0,s.aT)(t):t,n=u(e.length),a=1===e.length&&e[0]<128?1:e.length<=55?1+e.length:1+n+e.length;return{length:a,encode(t){1===e.length&&e[0]<128?t.pushBytes(e):e.length<=55?(t.pushByte(128+e.length),t.pushBytes(e)):(t.pushByte(183+n),1===n?t.pushUint8(e.length):2===n?t.pushUint16(e.length):3===n?t.pushUint24(e.length):t.pushUint32(e.length),t.pushBytes(e))}}}(t)}function u(t){if(t<256)return 1;if(t<65536)return 2;if(t<2**24)return 3;if(t<2**32)return 4;throw new a.C("Length is too large.")}},34316:(t,e,n)=>{n.d(e,{Zh:()=>c});var a=n(31376),r=n(52620),s=n(84117),i=n(94837),o=n(33998);function c(t){const{domain:e={},message:n,primaryType:a}=t,s={EIP712Domain:(0,o.H4)({domain:e}),...t.types};(0,o.$$)({domain:e,message:n,primaryType:a,types:s});const c=["0x1901"];return e&&c.push(function(t){let{domain:e,types:n}=t;return u({data:e,primaryType:"EIP712Domain",types:n})}({domain:e,types:s})),"EIP712Domain"!==a&&c.push(u({data:n,primaryType:a,types:s})),(0,i.S)((0,r.xW)(c))}function u(t){let{data:e,primaryType:n,types:a}=t;const r=d({data:e,primaryType:n,types:a});return(0,i.S)(r)}function d(t){let{data:e,primaryType:n,types:r}=t;const s=[{type:"bytes32"}],i=[l({primaryType:n,types:r})];for(const a of r[n]){const[t,n]=y({types:r,name:a.name,type:a.type,value:e[a.name]});s.push(t),i.push(n)}return(0,a.h)(s,i)}function l(t){let{primaryType:e,types:n}=t;const a=(0,s.nj)(function(t){let{primaryType:e,types:n}=t,a="";const r=p({primaryType:e,types:n});r.delete(e);const s=[e,...Array.from(r).sort()];for(const i of s)a+="".concat(i,"(").concat(n[i].map((t=>{let{name:e,type:n}=t;return"".concat(n," ").concat(e)})).join(","),")");return a}({primaryType:e,types:n}));return(0,i.S)(a)}function p(t){let{primaryType:e,types:n}=t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set;const r=e.match(/^\w*/u),s=null===r||void 0===r?void 0:r[0];if(a.has(s)||void 0===n[s])return a;a.add(s);for(const i of n[s])p({primaryType:i.type,types:n},a);return a}function y(t){let{types:e,name:n,type:r,value:o}=t;if(void 0!==e[r])return[{type:"bytes32"},(0,i.S)(d({data:o,primaryType:r,types:e}))];if("bytes"===r){const t=o.length%2?"0":"";return o="0x".concat(t+o.slice(2)),[{type:"bytes32"},(0,i.S)(o)]}if("string"===r)return[{type:"bytes32"},(0,i.S)((0,s.nj)(o))];if(r.lastIndexOf("]")===r.length-1){const t=r.slice(0,r.lastIndexOf("[")),s=o.map((a=>y({name:n,type:t,types:e,value:a})));return[{type:"bytes32"},(0,i.S)((0,a.h)(s.map((t=>{let[e]=t;return e})),s.map((t=>{let[,e]=t;return e}))))]}return[{type:r},o]}}}]);
//# sourceMappingURL=42624.fa467111.chunk.js.map